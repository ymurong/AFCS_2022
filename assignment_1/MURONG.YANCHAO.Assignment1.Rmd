---
header-includes:
- \usepackage{xcolor}
- \usepackage{color} 
- \usepackage{fancyhdr,color}
- \usepackage{lipsum}
- \fancyfoot[CE] {\thepage}
title: "**Assignment 1**"
subtitle: "Applied Forecasting in Complex Systems 2022"
author: Yanchao MURONG (14090759)
date: "University of Amsterdam \n &nbsp;  \n November, 7, 2022 "
output: pdf_document
fontsize: 11pt
highlight: tango
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  message = FALSE,
  warning = FALSE,
  cache = TRUE,
  dev.args = list(pointsize = 11)
)
options(digits = 3, width = 60)
library(fpp3)
library(latex2exp)
library(lubridate)
```

## **Exercise 1**\
**1.1)**
```{r}
pigs <- aus_livestock %>% 
  filter(State == "Victoria" & Animal == "Pigs" & between(year(Month), 1990, 1995))
pigs
```

**1.2)**
```{r, fig.show="hold", out.width="50%"}
par(mar = c(4, 4, .1, .1))
pigs %>% autoplot(Count)
pigs %>% ACF(Count, lag_max = 100) %>% 
  autoplot() +
  labs(title = "Autocorrealtion", y = "")
```
For white noise series, we expect each autocorrelation to be close to zero and less than 5% of splikes should be outside the blue bounds. However, from the above figure on the right, the values slowly decrease as the lags increase and we observe a lot of autocorrealtion coefficients lie outside the bounds. As a matter of fact, the ACF figure actually demontrates trends and seasonality caracteristics. 


**1.3)**

```{r}
all_pigs <- aus_livestock %>% 
  filter(State == "Victoria" & Animal == "Pigs")
all_pigs %>% ACF(Count, lag_max = 1000) %>% 
  autoplot() +
  labs(title = "Autocorrealtion", y = "")
```

Now, if we include the whole pigs data from 1972 to 2018 and draw the ACF plot, interestingly, when the lags become larger than 240, the data seems to demonstrate a white noise pattern, which might indicate that the pigs slaughtering pattern has been tremendously changed after 20 years and would be difficult to do predictions based the data 20 years ago.




## **Exercise 2**\
**2.1)**

```{r, fig.show="hold", out.width="50%"}
par(mar = c(4, 4, .1, .1))

global_economy %>%
  filter(Country=="United States") %>%
  autoplot(GDP) +
  labs(title= "GDP", y = "$US")

global_economy %>%
  filter(Country=="United States") %>%
  autoplot(GDP/Population) +
  labs(title= "GDP per capita", y = "$US")
```

We have done population adjustments and removed the population effect from the increase of GDP. 



**2.2)**

```{r, fig.show="hold", out.width="50%"}
par(mar = c(4, 4, .1, .1))

aus_livestock %>% 
  filter(State == "Victoria" & Animal == "Bulls, bullocks and steers") %>% 
  autoplot(Count)

aus_livestock %>% 
  filter(State == "Victoria" & Animal == "Bulls, bullocks and steers") %>% 
  mutate(daysofmonth = days_in_month(as_date(Month)))  %>% 
  mutate(countperday = Count/daysofmonth)  %>% 
  autoplot(countperday)
```
We have done calender adjustments by calculating the counts per day in each month rather than the total counts in the month, which remove the calendar variation.



**2.3)**

```{r, fig.show="hold", out.width="50%"}
par(mar = c(4, 4, .1, .1))

aus_production %>%
  autoplot(Gas)
  
lambda <- aus_production %>%
  features(Gas, features = guerrero) %>%
  pull(lambda_guerrero)

aus_production %>%
  autoplot(box_cox(Gas, lambda)) +
  labs(y = "",
       title = latex2exp::TeX(paste0(
         "Transformed gas production with $\\lambda$ = ",
         round(lambda,2))))
```

We applied the box cox transformation to make a constant variation with the level of the series.
